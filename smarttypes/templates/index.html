<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:py="http://genshi.edgewall.org/"
    xmlns:xi="http://www.w3.org/2001/XInclude"
    lang="en">

<xi:include href="master.html" />      

<head>

    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4/leaflet.css" />
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4/leaflet.ie.css" />
    <![endif]-->
    <script src="http://cdn.leafletjs.com/leaflet-0.4/leaflet.js"></script>

    <style type="text/css" media="screen">
        #map { height: 450px; }
        .leaflet-container { background:None; }
        .leaflet-popup-content {font:inherit;}
        .leaflet-container a {color: #606;}
    </style>

    <script type="text/javascript">
        $(function(){
            var reduction_id = ${reduction_id if reduction_id else 'undefined'};
            init_social_map(reduction_id);
        });
    </script>

</head>                    

<body>

    <div style="text-align:center;">
<!--         <div style="text-align:right;">
          <form style="text-align:center;" class="form-search">
            <input type="text" class="input-large" placeholder="@handle or some text ..." />
            <button type="submit" class="btn">
              <i class="icon-search"></i> Explore</button>
          </form>
        </div> -->

        <div py:if="reduction_id">
            <?python root_user = reduction.root_user()?>
            <h2>
                <img py:if="root_user.profile_image_url" 
                    src="${root_user.profile_image_url}" alt="root_user.screen_name" />
                 ${root_user.screen_name}'s social world
            </h2>
        </div>
        <div style="margin:20px 0;">
            <div id="map"></div>
        </div>

        <h2 style="margin-top:80px;">More social maps:</h2>
        <ul style="list-style:none;margin:10px 0;">
            <li py:if="user.id != root_user.id" style="margin:50px auto;width:400px;" 
                py:for="user, count in user_reduction_counts">

                <a py:if="user.profile_image_url" href="/${user.screen_name}">
                    <img py:if="user.profile_image_url" 
                        src="${user.profile_image_url}" alt="user.screen_name" />
                </a>

                <span style="font-weight:bold;">
                    <a href="/${user.screen_name}">${user.screen_name}</a>
                </span>

                <span style="font-style:italic;">
                    <br/>
                    ${user.location_name if user.location_name else 'No location given'}
                </span>

                <span py:if="user.description">
                    <br/>
                    ${user.description[:80]}${'...' if len(user.description) &gt; 80 else ''}
                </span>
            </li>
        </ul>
    </div>

</body>                                     
</html>

